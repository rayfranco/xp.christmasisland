(function(){var e;e=function(){function e(){}return e}()}).call(this),function(){var e;e=function(){function e(){}return e}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var a in n)e.call(n,a)&&(t[a]=n[a]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};if("undefined"==typeof $||null===$)throw"jQuery is not installed";if("undefined"==typeof buzz||null===buzz)throw"Buzz is not installed";$(function(){var e,n,i,a,s,o,r,u,l,c,E,d,h,p,y,g,m,w,f,T,H,R,v,z,b,x,W,M,k,I,S,C,P,N,V,B,j,G,L,O,U,F,A,_;return n=15e3,e=200,T=.5,k=new THREE.Scene,r=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,12e4),r.position.z=200,r.position.y=0,z={canvas:I,clearColor:16777215,clearAlpha:0,antialias:!1,autoClear:!1,gammaInput:!0,gammaOutput:!0,sort:!1},I=document.getElementById("scene"),W=new THREE.WebGLRenderer,W.setSize(window.innerWidth,window.innerHeight),x=new THREE.RenderPass(k,r),d=new THREE.FilmPass(3,.1,0,!0),h=new THREE.ShaderPass(THREE.VignetteShader),E=new THREE.ShaderPass(THREE.ColorifyShader),h.uniforms.offset.value=.8,h.uniforms.darkness.value=2,h.renderToScreen=!0,M={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!0},u=new THREE.EffectComposer(W,new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,M)),u.addPass(x),u.addPass(d),u.addPass(h),O=document.getElementById("trackerCanvas"),U=document.getElementById("trackerVideo"),y=new headtrackr.Tracker({ui:!1,headPosition:!0,calcAngles:!1}),y.init(U,O),y.start(),A="assets/textures/skybox/",_=[A+"posx.jpg",A+"negx.jpg",A+"posy.jpg",A+"negy.jpg",A+"posz.jpg",A+"negz.jpg"],B=THREE.ImageUtils.loadTextureCube(_),p=new THREE.SphereGeometry(100,32,16),w=new THREE.MeshBasicMaterial({color:16777215,envMap:B}),f=new THREE.Mesh(p,w),f.position.x=0,f.position.y=0,f.position.z=0,f.scale.x=f.scale.y=f.scale.z=1,k.add(f),s=new TWEEN.Tween(f.position).to({y:-20},5e3).easing(TWEEN.Easing.Cubic.InOut),o=new TWEEN.Tween(f.position).to({y:20},5e3).easing(TWEEN.Easing.Cubic.InOut),N=new TWEEN.Tween(f.position).to({y:20},2500).start().chain(s).easing(TWEEN.Easing.Cubic.Out),s.chain(o),o.chain(s),S=THREE.ShaderUtils.lib.cube,C={fragmentShader:S.fragmentShader,vertexShader:S.vertexShader,uniforms:S.uniforms,depthWrite:!1,side:THREE.BackSide},S.uniforms.tCube.value=B,w=new THREE.ShaderMaterial(C),f=new THREE.Mesh(new THREE.CubeGeometry(1e4,1e4,1e4),w),k.add(f),v=new THREE.PointLight(255),v.position.x=10,v.position.y=50,v.position.z=130,k.add(v),c=new THREE.DirectionalLight(16777215,1),c.position.x=1,c.position.y=1,c.position.z=0,k.add(c),g=new THREE.AmbientLight(6710886),k.add(g),a=function(){function e(e,t,n){var a,s,o,r;for(this.scene=e,this.subject=t,this.count=n,this.flakes=new THREE.Geometry,this.material=new THREE.ParticleBasicMaterial({size:5,map:THREE.ImageUtils.loadTexture("assets/particle.png"),blending:THREE.AdditiveBlending,transparent:!0}),this.points=new THREE.GeometryUtils.randomPointsInGeometry(this.subject,this.count),a=o=0,r=this.count;r>=0?r>o:o>r;a=r>=0?++o:--o)this.points[a]=new THREE.Vector3(400*Math.random()-200,400*Math.random()-200,2e3*Math.random()-1e3),s=new i(this.points[a],50),this.flakes.vertices.push(s);return this.system=new THREE.ParticleSystem(this.flakes,this.material),console.log(this.flakes),this.system.sortParticles=!0,console.log(this.flakes),this.scene.add(this.system),console.log(this.flakes),this}return e.prototype.update=function(){var e,t,n,i,a;for(i=this.flakes.vertices,a=[],t=0,n=i.length;n>t;t++)e=i[t],-200>e.y&&(e.y=200),-200>e.x&&(e.x=200),e.x>200?a.push(e.x=-200):(e.y-=.5*Math.random(),a.push(e.x-=.5*Math.random()));return a},e}(),i=function(e){function n(e,t){return null==t&&(t=2),this.velocity=new THREE.Vector3(0,-Math.random()+1,0),this.animation=null,this.x=e.x,this.y=e.y,this.z=e.z,this}return t(n,e),n}(THREE.Vector3),V=new a(k,p,n),P={preload:!0,autoplay:!1,loop:!0},j=new buzz.sound("assets/loop1.wav",P),G=new buzz.sound("assets/loop2.wav",P),L=new buzz.sound("assets/loop3.wav",P),buzz.all().bindOnce("canplaythrough",function(){return console.log("canplaythrough"),buzz.all().play()}),j.setVolume(100),G.setVolume(20),L.setVolume(0),buzz.all(),H=.5,R=.5,b=function(){var e,t;return TWEEN.update(),requestAnimationFrame(b),W.render(k,r),V.update(),e=400*H-200,t=Math.sqrt(Math.pow(200,2)-Math.pow(e,2)),new TWEEN.Tween(r.position).to({x:e},980).easing(TWEEN.Easing.Cubic.Out).start(),u.render(1e-4)},b(),F={getUserMedia:"You got that camera","no getUserMedia":"u shy ? Turn that camera on...","camera found":"Camera is working","no camera":"Hey, u dat shy ?",detecting:"Don't hide, tryin to find u...",found:"Gotcha ! You can move now :)",lost:"Hey !! Where are ya ??",redetecting:"Tryin to find you again"},document.addEventListener("headtrackrStatus",function(e){return e.status in F?console.log(F[e.status]):void 0}),document.addEventListener("facetrackingEvent",function(e){return H=T=1-e.x/318,R=1-e.y/240,j.setVolume(100*H),G.setVolume(100-100*H),L.setVolume(100-150*H)}),m=function(){var e;return e=new TWEEN.Tween({grayscale:0,nIntensity:.1}).to({grayscale:1,nIntensity:3},500).easing(TWEEN.Easing.Cubic.Out),e.onUpdate(function(){return d.uniforms.grayscale.value=this.grayscale,d.uniforms.nIntensity.value=this.nIntensity}),e.start()},l=function(){var e;return e=new TWEEN.Tween({grayscale:1,nIntensity:3}).to({grayscale:0,nIntensity:.1},500).easing(TWEEN.Easing.Cubic.Out),e.onUpdate(function(){return d.uniforms.grayscale.value=this.grayscale,d.uniforms.nIntensity.value=this.nIntensity}),e.start()}})}.call(this);